# 2. Задачі щоденні: Детальний опис фронтенду

**Основний компонент:** `src/app/(app)/tasks/page.tsx`

## Компоненти та їх взаємодія

### 1. `TasksPage` (головний компонент)
-   **Стан (State):**
    -   `currentDate`: Поточна обрана дата.
    -   `tasks`: Масив задач, завантажених для обраної дати та фільтру.
    -   `selectedTask`: Об'єкт обраної задачі для відображення в бічній панелі.
    -   `activeTab`: Поточний фільтр ('mine', 'delegated', 'subordinates').
    -   `currentUser`: Профіль поточного користувача.
    -   `isPending`: Прапорець завантаження даних.
-   **Логіка:**
    -   При першому завантаженні та при зміні дати/фільтру викликає серверний екшен `getTasksForDate` для отримання актуального списку задач.
    -   Керує відкриттям/закриттям бічної панелі `TaskDetailsPanel`, передаючи в неї `selectedTask`.
    -   Обробляє створення, оновлення та видалення задач, оновлюючи локальний стан `tasks` для миттєвого відображення змін в UI.

### 2. `TasksHeader` (`src/components/tasks/tasks-header.tsx`)
-   **Призначення:** Відображення та керування поточною датою і фільтрами.
-   **Елементи:**
    -   **Кнопки `<` та `>`:** Змінюють `currentDate` на один день назад або вперед. Викликають `onDateChange`.
    -   **Кнопка з датою:** Відображає поточну дату. При натисканні відкриває `Popover` з компонентом `Calendar` для швидкого вибору довільної дати. Викликає `onDateChange`.
    -   **Вкладки (Tabs) "Мої", "Делеговані", "Підлеглих":** Перемикають `activeTab`. Викликають `onTabChange`.

### 3. `TaskItem` (`src/components/tasks/task-item.tsx`)
-   **Призначення:** Рядок у таблиці, що представляє одну задачу.
-   **Елементи:**
    -   **Чекбокс:** Відображає статус `done`/`todo`. При натисканні на невиконану задачу відкриває діалогове вікно `Dialog` для введення фактичного результату та часу.
    -   **Назва задачі:** Поле `Input`, що дозволяє швидко редагувати назву прямо в списку. Зберігає зміни при втраті фокусу (`onBlur`).
    -   **Бейдж типу:** (видимий на вкладці "Мої") Відображає колір та назву типу задачі за матрицею Ейзенхауера.
    -   **Колонки "План. час" та "Факт. час":** Відображають час. Поле "Факт. час" є `Input` для швидкого редагування.
    -   **Кнопки дій (з'являються при наведенні):**
        -   `Edit`: Відкриває бічну панель деталей. Викликає `onSelect`.
        -   `Clock`: (Функціонал "відкласти" - не реалізовано).
        -   `CalendarIcon`: Відкриває `Popover` з календарем для швидкої зміни `dueDate`.
        -   `Trash2` (в `DropdownMenu`): Відкриває `AlertDialog` для підтвердження видалення задачі. Викликає `onDelete`.

### 4. `TaskDetailsPanel` (`src/components/tasks/task-details-panel.tsx`)
-   **Призначення:** Бічна панель для детального перегляду та редагування задачі.
-   **Логіка:** Отримує об'єкт `task` як `prop`. При будь-якій зміні полів викликає `onUpdate` для збереження даних.
-   **Елементи:**
    -   **Заголовок:** Назва задачі (редаговане поле `Input`).
    -   **Відповідальний/Постановник:** Випадаючі списки `Select` для зміни `assignee` та `reporter`.
    -   **Дата/Тип/Час:** Інтерактивні елементи для редагування відповідних полів.
    -   **Опис/Очікуваний результат/Фактичний результат:** Поля `Textarea` для редагування текстових блоків.
    -   **Коментарі:** (Функціонал не реалізовано) Секція для додавання та перегляду коментарів.

### 5. `ResultsList` (`src/components/tasks/results-list.tsx`)
-   **Призначення:** Панель справа (видима, коли не обрано жодної задачі) для швидкого створення задач з результатів.
-   **Логіка:**
    -   Завантажує список активних результатів та підрезультатів через екшен `getResults`.
    -   При кліку на будь-який елемент списку викликає `onResultClick`, передаючи назву та батьківський результат для створення нової задачі з відповідним контекстом.

### 6. Поле "Нова задача..."
-   **Призначення:** Швидке створення задачі.
-   **Логіка:** Поле `Input` внизу сторінки. При натисканні `Enter` викликає `handleCreateTask` з текстом з поля, створюючи нову задачу на поточний день.

### 7. Попередження про навантаження
-   **Логіка:** Компонент `Card` з'являється, коли сума `expectedTime` для всіх задач на день перевищує 360 хвилин. Колір змінюється на червоний при перевищенні 480 хвилин.
