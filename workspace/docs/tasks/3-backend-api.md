# 3. Задачі щоденні: Специфікація API бекенду

Цей документ описує API-ендпоінти, які має реалізувати зовнішній бекенд для забезпечення функціональності сторінки "Задачі щоденні".

**Базова URL:** `https://<your-backend-url>/api`

**Автентифікація:** Всі запити вимагають `Bearer <permanent_jwt_token>` в заголовку `Authorization`.

---

## 1. Отримання задач на конкретну дату

-   **Ендпоінт:** `GET /tasks`
-   **Призначення:** Отримати список всіх задач, що відносяться до компанії користувача та відповідають заданим фільтрам.
-   **Параметри запиту (Query Params):**
    -   `date` (обов'язково): Дата у форматі `YYYY-MM-DD`.
    -   `filter` (обов'язково): Тип фільтру:
        -   `mine`: Задачі, де поточний користувач (визначений з JWT) є `assignee`.
        -   `delegated`: Задачі, де поточний користувач є `reporter`, але не є `assignee`.
        -   `subordinates`: Задачі, де `assignee` є підлеглим поточного користувача (логіка ієрархії реалізується на бекенді).
-   **Приклад запиту:** `GET /tasks?date=2024-10-03&filter=mine`

-   **Успішна відповідь (200 OK):**
    -   **Тіло відповіді:** Масив об'єктів задач.
    ```json
    [
      {
        "id": "task-123",
        "title": "Підготувати щотижневий звіт",
        "description": "Зібрати дані з аналітики та підготувати презентацію.",
        "dueDate": "2024-10-03",
        "status": "todo",
        "type": "important-not-urgent",
        "expectedTime": 90,
        "actualTime": null,
        "expectedResult": "Презентація з 5 слайдів.",
        "actualResult": null,
        "assignee": { "id": "user-1", "name": "Олена Ковальчук", "avatar": "url..." },
        "reporter": { "id": "user-2", "name": "Іван Петренко", "avatar": "url..." },
        "resultId": "res-45",
        "resultName": "Запустити рекламну кампанію"
      }
    ]
    ```

---

## 2. Створення нової задачі

-   **Ендпоінт:** `POST /tasks`
-   **Призначення:** Створити нову задачу.
-   **Тіло запиту:** `Omit<Task, 'id' | 'companyId'>`. Бекенд має сам визначити `companyId` з JWT.
    ```json
    {
      "title": "Зателефонувати клієнту",
      "dueDate": "2024-10-03",
      "status": "todo",
      "type": "important-urgent",
      "assignee": { "id": "user-1", "name": "Олена Ковальчук" },
      "reporter": { "id": "user-1", "name": "Олена Ковальчук" },
      "expectedTime": 15,
      "resultId": "res-46"
    }
    ```
-   **Успішна відповідь (201 Created):**
    -   **Тіло відповіді:** Повний об'єкт створеної задачі з присвоєним `id`.
    ```json
    {
      "id": "task-124",
      "title": "Зателефонувати клієнту",
      "dueDate": "2024-10-03",
      // ... всі інші поля
    }
    ```

---

## 3. Оновлення задачі

-   **Ендпоінт:** `PUT /tasks/{id}`
-   **Призначення:** Оновити будь-які поля існуючої задачі.
-   **Параметри URL:**
    -   `id`: ID задачі, яку потрібно оновити.
-   **Тіло запиту:** `Partial<Task>`. Об'єкт, що містить лише ті поля, які потрібно змінити.
    ```json
    {
      "status": "done",
      "actualResult": "Клієнт погодився на зустріч.",
      "actualTime": 25
    }
    ```
-   **Логіка бекенду:** При зміні `status` на `done`, якщо `assigneeId` не дорівнює `reporterId`, бекенд має автоматично створити нову "задачу на перевірку" для `reporter`.
-   **Успішна відповідь (200 OK):**
    -   **Тіло відповіді:** Повний, оновлений об'єкт задачі.

---

## 4. Видалення задачі

-   **Ендпоінт:** `DELETE /tasks/{id}`
-   **Призначення:** Видалити задачу.
-   **Параметри URL:**
    -   `id`: ID задачі для видалення.
-   **Успішна відповідь (204 No Content):**
    -   Повертає пусте тіло відповіді зі статусом 204.
